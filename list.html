<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Content list</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="container">
    <header>
      <h1>Content</h1>
      <p class="subtitle">Browse site content by category</p>
    </header>

    <nav class="main-nav">
      <a href="index.html">home</a>
      <a href="list.html?category=thoughts">thoughts</a>
      <a href="list.html?category=projects">projects</a>
      <a href="list.html?category=ideas">ideas</a>
      <a href="resume.html">resume</a>
      <a href="list.html">all</a>
    </nav>

    <section>
      <div id="list-root">Loadingâ€¦</div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    (async function(){
      const params = new URLSearchParams(location.search);
      const category = params.get('category');
      const root = document.getElementById('list-root');
      try{
        const r = await fetch('content/index.json');
        if(!r.ok) throw new Error('No manifest');
        const items = await r.json();
        const filtered = category ? items.filter(i=>i.category===category) : items;

        if(filtered.length === 0) {
          root.innerHTML = '<p>No content found for that category.</p>';
          return;
        }

        const ul = document.createElement('ul');
        ul.className = 'simple-list';
        filtered.forEach(it=>{
          const li = document.createElement('li');
          const a = document.createElement('a');
          // link to view.html with file slug
          a.href = `view.html?file=${encodeURIComponent(it.file)}`;
          a.textContent = it.title || it.file;
          li.appendChild(a);
          if(it.date){
            const d = document.createElement('span'); d.className='date'; d.textContent = ' ' + it.date; li.appendChild(d);
          }
          if(it.excerpt){
            const ex = document.createElement('div'); ex.className='description'; ex.textContent = it.excerpt; li.appendChild(ex);
          }
          ul.appendChild(li);
        });
        root.innerHTML = '';
        root.appendChild(ul);
      }catch(err){
        root.innerHTML = '<p>Unable to load content manifest. Run the generator or add content/index.json.</p>';
        console.warn(err);
      }
    })();
  </script>
</body>
</html>
